<div id="admin-comments">
    <h2>Gerenciar Comentários</h2>
    <div id="comment-list"></div>
    <form id="comment-form">
        <input type="text" placeholder="Nome" id="name" />
        <textarea placeholder="Comentário" id="comment"></textarea>
        <input type="file" id="photo" />
        <button type="submit">Salvar</button>
    </form>
</div>

const client = sanityClient({
  projectId: 'seu-id-do-projeto',
  dataset: 'production',
  apiVersion: '2021-10-21',
  useCdn: true,
});

async function fetchComments() {
  const comments = await client.fetch(`*[_type == "comment"]{
    name,
    comment,
    "photoUrl": photo.asset->url
  }`);
  renderComments(comments);
}

function renderComments(comments) {
  const commentList = document.getElementById('comment-list');
  commentList.innerHTML = comments.map(comment => `
    <div class="comment">
      <img src="${comment.photoUrl}" alt="Foto" />
      <strong>${comment.name}</strong>
      <p>${comment.comment}</p>
      <button onclick="editComment('${comment._id}')">Editar</button>
    </div>
  `).join('');
}

fetchComments();

async function editComment(commentId) {
  const commentToEdit = await client.getDocument(commentId);

  // Preencher o formulário com os dados atuais
  document.getElementById('edit-name').value = commentToEdit.name;
  document.getElementById('edit-comment').value = commentToEdit.comment;

  document.getElementById('save-btn').onclick = async () => {
    await client.patch(commentId)
      .set({
        name: document.getElementById('edit-name').value,
        comment: document.getElementById('edit-comment').value
      })
      .commit();
    fetchComments(); // Recarregar os comentários atualizados
  };
}

<div id="edit-form">
  <input type="text" id="edit-name" placeholder="Nome" />
  <textarea id="edit-comment" placeholder="Comentário"></textarea>
  <button id="save-btn">Salvar</button>
</div>

